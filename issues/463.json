{
    "assignee": null,
    "body": "Hello :)\r\n\r\nWas reading the whatsprot.class.php class to know what methods I can use. I have seen some that could be usefull for receiving many messages: sendMessageReceived(), waitForServer(), waitForMessageReceipt(). \r\nI guess it's sendMessageReceived() that do what I want (i.e don't overload WhatsApp servers, be fair to the ressources) but I am still unsure.\r\n\r\nFor now, here is what I am doing (from exemple):\r\n\r\n\t$w = new WhatsProt($sender, $imei, $nickname, FALSE);\r\n\t$w->eventManager()->bind(\"onGetMessage\", \"onMessage\"); //add function onMessage to the built-in onGetMessage\r\n\t$w->Connect();\r\n\t$w->LoginWithPassword($password);\r\n\t//GET MESSAGE WITH EVENTS (with eventManager())                                 \r\n\t$w->PollMessages();\r\n\r\nfunction onMessage($mynumber, $from, $id, $type, $time, $name, $body)\r\n{\r\n//log into DB\r\n}\r\n\r\nI know I am missing something to tell the server : \"I have correctly received the server, make a pause, get the next one\".\r\n\r\nThank you in advance if you could find some time for this :)\r\n(maybe add an exemple in the wiki? just a little suggestion if you want ^^)",
    "closed_at": "2013-09-16T14:01:34Z",
    "comment_data": [
        {
            "body": "Received messages are automatically answered by processInboundData before firing the onMessage event\r\nhttps://github.com/venomous0x/WhatsAPI/blob/master/src/php/whatsprot.class.php#L1684",
            "created_at": "2013-09-11T12:42:03Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463#issuecomment-24236511",
            "id": 24236511,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
            "updated_at": "2013-09-11T12:42:03Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/24236511",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            }
        },
        {
            "body": "Excuse me I'm not sure I understand, are you saying that on each message received the core of WhatsAPI calls sendMessageReceived() ?\r\n(edit: I have some trouble describing my problem in english; I opened this issue to understand more how WhatsAPI works because when I call my php page, let's say 4 times, I will have the same received message written 4 times. So that's why I wanted to know if I needed a method to tell whatsapp I've received the message or if I must manage this oterwise. Sorry for the bad synthax, I can rewrite it if you want^^)",
            "created_at": "2013-09-11T13:22:45Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463#issuecomment-24239083",
            "id": 24239083,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
            "updated_at": "2013-09-11T13:46:22Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/24239083",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
                "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
                "followers_url": "https://api.github.com/users/slobo42/followers",
                "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
                "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/slobo42",
                "id": 5312598,
                "login": "slobo42",
                "organizations_url": "https://api.github.com/users/slobo42/orgs",
                "received_events_url": "https://api.github.com/users/slobo42/received_events",
                "repos_url": "https://api.github.com/users/slobo42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/slobo42"
            }
        },
        {
            "body": "@slobo42 yes thats correct. You dont have to execute \"SendMessageReceived\" manually. I dont know how exactly your whole php script works, but maybe due to this reloading of the page, the socket does not get filled with new data and processes the old data over and over again.\r\n\r\nTry putting \"PollMessages\" into a loop, and make sure, that you dont always reconnect to the whatsapp server.",
            "created_at": "2013-09-11T15:20:54Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463#issuecomment-24249216",
            "id": 24249216,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
            "updated_at": "2013-09-11T15:20:54Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/24249216",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5272979?v=3",
                "events_url": "https://api.github.com/users/xX7/events{/privacy}",
                "followers_url": "https://api.github.com/users/xX7/followers",
                "following_url": "https://api.github.com/users/xX7/following{/other_user}",
                "gists_url": "https://api.github.com/users/xX7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xX7",
                "id": 5272979,
                "login": "xX7",
                "organizations_url": "https://api.github.com/users/xX7/orgs",
                "received_events_url": "https://api.github.com/users/xX7/received_events",
                "repos_url": "https://api.github.com/users/xX7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xX7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xX7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xX7"
            }
        },
        {
            "body": "@xX7 thank you for the information, now I know the issue is not because I forget a method. I will look more \r\nthoroughly my script to see if I have made to many Connect() but I think I will try first putting PollMessages in a loop like you said. I've seen some people doing: for($i = 0; $i < 5; $i++) { w->PollMessages(); }  I don't know why 5, maybe it's to avoid writing sleep(1) to not stress out the server. (Will close the issue if this solved it) :)",
            "created_at": "2013-09-12T08:44:58Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463#issuecomment-24303243",
            "id": 24303243,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
            "updated_at": "2013-09-12T08:44:58Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/24303243",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
                "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
                "followers_url": "https://api.github.com/users/slobo42/followers",
                "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
                "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/slobo42",
                "id": 5312598,
                "login": "slobo42",
                "organizations_url": "https://api.github.com/users/slobo42/orgs",
                "received_events_url": "https://api.github.com/users/slobo42/received_events",
                "repos_url": "https://api.github.com/users/slobo42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/slobo42"
            }
        },
        {
            "body": "You're over-thinking it too much :)\r\n\r\nThe 5 just seems like a reasonable number. The socket timeout is set to 2 seconds so calling pollMessages 5 times will take no more than 10 seconds",
            "created_at": "2013-09-12T09:03:36Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463#issuecomment-24304112",
            "id": 24304112,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
            "updated_at": "2013-09-12T09:03:36Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/24304112",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            }
        },
        {
            "body": "I ran some tests with this loop on PollMessages and it worked like a charm, the page is not that slow to load so it's good news. You are right, I was over-thinking it but in reality it is quite simple. \r\n\r\nSo, thanks again for giving this helpful information :).",
            "created_at": "2013-09-16T14:01:34Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463#issuecomment-24511708",
            "id": 24511708,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
            "updated_at": "2013-09-16T14:01:34Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/24511708",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
                "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
                "followers_url": "https://api.github.com/users/slobo42/followers",
                "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
                "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/slobo42",
                "id": 5312598,
                "login": "slobo42",
                "organizations_url": "https://api.github.com/users/slobo42/orgs",
                "received_events_url": "https://api.github.com/users/slobo42/received_events",
                "repos_url": "https://api.github.com/users/slobo42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/slobo42"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463/comments",
    "created_at": "2013-09-11T12:38:19Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
                "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
                "followers_url": "https://api.github.com/users/slobo42/followers",
                "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
                "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/slobo42",
                "id": 5312598,
                "login": "slobo42",
                "organizations_url": "https://api.github.com/users/slobo42/orgs",
                "received_events_url": "https://api.github.com/users/slobo42/received_events",
                "repos_url": "https://api.github.com/users/slobo42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/slobo42"
            },
            "commit_id": null,
            "created_at": "2013-09-11T15:20:54Z",
            "event": "mentioned",
            "id": 64941637,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/64941637"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
                "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
                "followers_url": "https://api.github.com/users/slobo42/followers",
                "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
                "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/slobo42",
                "id": 5312598,
                "login": "slobo42",
                "organizations_url": "https://api.github.com/users/slobo42/orgs",
                "received_events_url": "https://api.github.com/users/slobo42/received_events",
                "repos_url": "https://api.github.com/users/slobo42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/slobo42"
            },
            "commit_id": null,
            "created_at": "2013-09-11T15:20:54Z",
            "event": "subscribed",
            "id": 64941638,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/64941638"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5272979?v=3",
                "events_url": "https://api.github.com/users/xX7/events{/privacy}",
                "followers_url": "https://api.github.com/users/xX7/followers",
                "following_url": "https://api.github.com/users/xX7/following{/other_user}",
                "gists_url": "https://api.github.com/users/xX7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xX7",
                "id": 5272979,
                "login": "xX7",
                "organizations_url": "https://api.github.com/users/xX7/orgs",
                "received_events_url": "https://api.github.com/users/xX7/received_events",
                "repos_url": "https://api.github.com/users/xX7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xX7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xX7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xX7"
            },
            "commit_id": null,
            "created_at": "2013-09-12T08:44:58Z",
            "event": "mentioned",
            "id": 65086041,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/65086041"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5272979?v=3",
                "events_url": "https://api.github.com/users/xX7/events{/privacy}",
                "followers_url": "https://api.github.com/users/xX7/followers",
                "following_url": "https://api.github.com/users/xX7/following{/other_user}",
                "gists_url": "https://api.github.com/users/xX7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xX7",
                "id": 5272979,
                "login": "xX7",
                "organizations_url": "https://api.github.com/users/xX7/orgs",
                "received_events_url": "https://api.github.com/users/xX7/received_events",
                "repos_url": "https://api.github.com/users/xX7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xX7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xX7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xX7"
            },
            "commit_id": null,
            "created_at": "2013-09-12T08:44:58Z",
            "event": "subscribed",
            "id": 65086042,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/65086042"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
                "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
                "followers_url": "https://api.github.com/users/slobo42/followers",
                "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
                "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/slobo42",
                "id": 5312598,
                "login": "slobo42",
                "organizations_url": "https://api.github.com/users/slobo42/orgs",
                "received_events_url": "https://api.github.com/users/slobo42/received_events",
                "repos_url": "https://api.github.com/users/slobo42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/slobo42"
            },
            "commit_id": null,
            "created_at": "2013-09-16T14:01:34Z",
            "event": "closed",
            "id": 65603485,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/65603485"
        }
    ],
    "events_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463/events",
    "html_url": "https://github.com/venomous0x/WhatsAPI/issues/463",
    "id": 19316533,
    "labels": [],
    "labels_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 463,
    "state": "closed",
    "title": "the proper way to receive many messages",
    "updated_at": "2013-09-16T14:01:34Z",
    "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/463",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/5312598?v=3",
        "events_url": "https://api.github.com/users/slobo42/events{/privacy}",
        "followers_url": "https://api.github.com/users/slobo42/followers",
        "following_url": "https://api.github.com/users/slobo42/following{/other_user}",
        "gists_url": "https://api.github.com/users/slobo42/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/slobo42",
        "id": 5312598,
        "login": "slobo42",
        "organizations_url": "https://api.github.com/users/slobo42/orgs",
        "received_events_url": "https://api.github.com/users/slobo42/received_events",
        "repos_url": "https://api.github.com/users/slobo42/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/slobo42/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/slobo42/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/slobo42"
    }
}