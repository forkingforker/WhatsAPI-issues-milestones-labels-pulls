{
    "assignee": null,
    "body": "Help please\r\n\r\nAnyone know why I get this error\r\n\r\n\r\n\r\nPHP Fatal error:  Uncaught exception 'Exception' with message 'BinTreeNodeReader->readListSize: Invalid token 159' in /var/www/Whatsapp/protocol.class.php:258\r\nStack trace:\r\n0 /var/www/Whatsapp/protocol.class.php(212): BinTreeNodeReader->readListSize(159)\r\n1 /var/www/Whatsapp/protocol.class.php(146): BinTreeNodeReader->nextTreeInternal()\r\n2 /var/www/Whatsapp/whatsprot.class.php(336): BinTreeNodeReader->nextTree('??Rv??d??1???v?...')\r\n3 /var/www/Whatsapp/whatsprot.class.php(615): WhatsProt->processInboundData('??Rv??d??1???v?...')\r\n4 /var/www/Whatsapp/whatsprot.class.php(765): WhatsProt->PollMessages()\r\n5 /var/www/Whatsapp/whatsprot.class.php(263): WhatsProt->WaitforServer('1368737605-2')\r\n6 /var/www/Whatsapp/whatsprot.class.php(718): WhatsProt->SendMessageNode('xxxxxxxx@s.w...', Object(ProtocolNode))\r\n7 /var/www/Whatsapp/whatsprot.class.php(515): WhatsProt->processUploadResponse(Object(ProtocolNode))\r\n8 /var/www/Whatsapp/whatsprot.class.php(615): WhatsProt->processInboundData('????W??8???^H?O...')\r\n9 /var/www/Whatsapp/whatsp in /var/www/Whatsapp/protocol.class.php on line 258\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "body": "I forgot to include the call stack here it goes again...\r\nPHP Fatal error:  Uncaught exception 'Exception' with message 'BinTreeNodeReader->readListSize: Invalid token 60' in C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\r\n\\php\\protocol.class.php:271\r\nStack trace:\r\n#0 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\protocol.class.php(225): BinTreeNodeReader->readListSize(60)\r\n#1 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\protocol.class.php(159): BinTreeNodeReader->nextTreeInternal()\r\n#2 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php(1486): BinTreeNodeReader->nextTree('?????Tr='`0U%??...')\r\n#3 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php(386): WhatsProt->processInboundData('?????Tr='`0U%??...')\r\n#4 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php(1165): WhatsProt->pollMessages()\r\n#5 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php(2015): WhatsProt->waitForServer('message-1373823...')\r\n#6 C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php(735): WhatsProt->sendMessageNode('19564002055', Object(ProtocolNode))\r\n#7 C:\\wamp\\www\\whatsapp\\getMessages.php(49): WhatsProt->sendMessage( in C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\protocol.class.php on line 271\r\n\r\nFatal error: Uncaught exception 'Exception' with message 'BinTreeNodeReader->readListSize: Invalid token 60' in C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\\r\nprotocol.class.php on line 271\r\n\r\nException: BinTreeNodeReader->readListSize: Invalid token 60 in C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\protocol.class.php on line 271\r\n\r\nCall Stack:\r\n    0.0005     340040   1. {main}() C:\\wamp\\www\\whatsapp\\getMessages.php:0\r\n    0.3750    1653176   2. WhatsProt->pollMessages() C:\\wamp\\www\\whatsapp\\getMessages.php:73\r\n    0.3776    1653384   3. WhatsProt->processInboundData() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:386\r\n    0.3838    1657752   4. WhatsAppEvent->fire() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:1528\r\n    0.3838    1657784   5. call_user_func_array() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\WhatsAppEvent.php:66\r\n    0.3838    1658280   6. onMessage() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\WhatsAppEvent.php:66\r\n    0.3863    1658488   7. WhatsProt->sendMessage() C:\\wamp\\www\\whatsapp\\getMessages.php:49\r\n    0.3867    1658960   8. WhatsProt->sendMessageNode() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:735\r\n    0.3902    1663136   9. WhatsProt->waitForServer() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:2015\r\n    0.3903    1663200  10. WhatsProt->pollMessages() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:1165\r\n    0.3903    1663264  11. WhatsProt->processInboundData() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:386\r\n    0.3903    1663264  12. BinTreeNodeReader->nextTree() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\whatsprot.class.php:1486\r\n    0.3908    1663304  13. BinTreeNodeReader->nextTreeInternal() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\protocol.class.php:159\r\n    0.3908    1663336  14. BinTreeNodeReader->readListSize() C:\\wamp\\www\\whatsapp\\WhatsAPI\\src\\php\\protocol.class.php:225\r\n\r\n\r\n\r\nif I receive a message while the listener is not running and I run the script it crash like this.....  if I receive three messages, my script will crash 3 times...... I guess the buffer need to be empty...... any ideas of how I can fix this?",
            "created_at": "2013-07-14T17:58:00Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/353#issuecomment-20940505",
            "id": 20940505,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353",
            "updated_at": "2013-07-14T17:58:00Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/20940505",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1237174?v=3",
                "events_url": "https://api.github.com/users/blackmlm/events{/privacy}",
                "followers_url": "https://api.github.com/users/blackmlm/followers",
                "following_url": "https://api.github.com/users/blackmlm/following{/other_user}",
                "gists_url": "https://api.github.com/users/blackmlm/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/blackmlm",
                "id": 1237174,
                "login": "blackmlm",
                "organizations_url": "https://api.github.com/users/blackmlm/orgs",
                "received_events_url": "https://api.github.com/users/blackmlm/received_events",
                "repos_url": "https://api.github.com/users/blackmlm/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/blackmlm/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/blackmlm/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/blackmlm"
            }
        },
        {
            "body": "https://github.com/venomous0x/WhatsAPI/issues/456",
            "created_at": "2013-12-18T13:19:30Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/353#issuecomment-30840704",
            "id": 30840704,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353",
            "updated_at": "2013-12-18T13:19:30Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/30840704",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/604766?v=3",
                "events_url": "https://api.github.com/users/DurtyFree/events{/privacy}",
                "followers_url": "https://api.github.com/users/DurtyFree/followers",
                "following_url": "https://api.github.com/users/DurtyFree/following{/other_user}",
                "gists_url": "https://api.github.com/users/DurtyFree/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/DurtyFree",
                "id": 604766,
                "login": "DurtyFree",
                "organizations_url": "https://api.github.com/users/DurtyFree/orgs",
                "received_events_url": "https://api.github.com/users/DurtyFree/received_events",
                "repos_url": "https://api.github.com/users/DurtyFree/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/DurtyFree/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/DurtyFree/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/DurtyFree"
            }
        },
        {
            "body": "I did several tests and discovered that the error occurs, but sends the message correctly.",
            "created_at": "2013-12-18T14:44:36Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/353#issuecomment-30846594",
            "id": 30846594,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353",
            "updated_at": "2013-12-18T14:44:36Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/30846594",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2752593?v=3",
                "events_url": "https://api.github.com/users/manufuentescr/events{/privacy}",
                "followers_url": "https://api.github.com/users/manufuentescr/followers",
                "following_url": "https://api.github.com/users/manufuentescr/following{/other_user}",
                "gists_url": "https://api.github.com/users/manufuentescr/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/manufuentescr",
                "id": 2752593,
                "login": "manufuentescr",
                "organizations_url": "https://api.github.com/users/manufuentescr/orgs",
                "received_events_url": "https://api.github.com/users/manufuentescr/received_events",
                "repos_url": "https://api.github.com/users/manufuentescr/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/manufuentescr/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/manufuentescr/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/manufuentescr"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353/comments",
    "created_at": "2013-05-16T21:17:53Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353/events",
    "html_url": "https://github.com/venomous0x/WhatsAPI/issues/353",
    "id": 14427296,
    "labels": [],
    "labels_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 353,
    "state": "open",
    "title": "Invalid token",
    "updated_at": "2013-12-18T14:44:36Z",
    "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/353",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/2752593?v=3",
        "events_url": "https://api.github.com/users/manufuentescr/events{/privacy}",
        "followers_url": "https://api.github.com/users/manufuentescr/followers",
        "following_url": "https://api.github.com/users/manufuentescr/following{/other_user}",
        "gists_url": "https://api.github.com/users/manufuentescr/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/manufuentescr",
        "id": 2752593,
        "login": "manufuentescr",
        "organizations_url": "https://api.github.com/users/manufuentescr/orgs",
        "received_events_url": "https://api.github.com/users/manufuentescr/received_events",
        "repos_url": "https://api.github.com/users/manufuentescr/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/manufuentescr/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/manufuentescr/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/manufuentescr"
    }
}