{
    "assignee": null,
    "body": "- Reference #387 \r\n\r\nHello, im trying to check the user online/offline status every minute. I have this code:\r\n\r\n**Note:** I tried both onGetPresence and onPresence\r\n\r\n```php\r\nfunction onPresenceReceived($username, $from, $type)\r\n{\r\n    echo \"The user is now\" . $type;\r\n}\r\n\r\n...\r\n\r\n$wa->eventManager()->bind(\"onGetPresence\", \"onPresenceReceived\");\r\nwhile(true){\r\n\t$wa->SendPresenceSubscription($dst);\r\n\tsleep(60);\r\n\t}\r\n```\r\nI was testing with an active number, going online and offline, and nothing happened, this is the output, every 60 seconds:\r\n\r\nIt does not noticed me when the user went online or offline.\r\n```\r\ntx  <presence type=\"subscribe\" to=\"34*********@s.whatsapp.net\"></presence>\r\ntx  <presence type=\"subscribe\" to=\"34*********@s.whatsapp.net\"></presence>\r\ntx  <presence type=\"subscribe\" to=\"34*********@s.whatsapp.net\"></presence>\r\n....\r\n```\r\n\r\nAny ideas?\r\n\r\nThanks :)",
    "closed_at": "2014-05-27T22:20:09Z",
    "comment_data": [
        {
            "body": "You only need to call SendPresenceSubscription once.\r\nPresence subscription is an async function which automatically notifies you when a user's presence changes:\r\n```php\r\n$wa->SendPresenceSubscription($dst);\r\nwhile(true){\r\n    $wa->PollMessages();\r\n    sleep(60);\r\n}\r\n```",
            "created_at": "2014-05-27T12:02:06Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747#issuecomment-44266430",
            "id": 44266430,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
            "updated_at": "2014-05-27T12:04:08Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/44266430",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            }
        },
        {
            "body": "@shirioko Yeah, i know, but it doesnt do anything, I tried that already :/ But it never notice me when the user goes online and that...\r\n\r\n```php\r\nfunction onPresenceReceived($username, $from, $type)\r\n{\r\n    echo \"The user is now\" . $type;\r\n}\r\n\r\n...\r\n\r\n$wa->eventManager()->bind(\"onGetPresence\", \"onPresenceReceived\");\r\n    $wa->SendPresenceSubscription($dst);\r\nwhile(true){\r\n    sleep(60);\r\n    }\r\n```",
            "created_at": "2014-05-27T12:05:57Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747#issuecomment-44266710",
            "id": 44266710,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
            "updated_at": "2014-05-27T12:05:57Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/44266710",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        },
        {
            "body": "You're missing a space in \r\n```php\r\necho \"The user is now\" . $type;\r\n```",
            "created_at": "2014-05-27T12:18:15Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747#issuecomment-44267709",
            "id": 44267709,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
            "updated_at": "2014-05-27T12:18:15Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/44267709",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            }
        },
        {
            "body": "@shirioko Right, but if i use:\r\n```php\r\necho \"Test\";\r\n```\r\ninstead, still not work. Maybe the while interfere to display the text?",
            "created_at": "2014-05-27T12:24:25Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747#issuecomment-44268254",
            "id": 44268254,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
            "updated_at": "2014-05-27T12:24:25Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/44268254",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        },
        {
            "body": "I think that the problem is inside into a while, because you make a sleep, the problem is in there...\r\n\r\nI think is better try while (true){ limit(60);\r\n}\r\n\r\nThis method no make a pause in script... Or you can make a Ajax call from other page with interval that you want...\r\n\r\nSaludos Jesús Sales\r\n\r\n> El 27/05/2014, a las 14:24, mgp25 <notifications@github.com> escribió:\r\n> \r\n> @shirioko Right, but if i use:\r\n> \r\n> echo \"Test\";\r\n> instead, still not work. Maybe the while interfere to display the text?\r\n> \r\n> —\r\n> Reply to this email directly or view it on GitHub.",
            "created_at": "2014-05-27T12:39:28Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747#issuecomment-44269717",
            "id": 44269717,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
            "updated_at": "2014-05-27T12:39:28Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/44269717",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2803224?v=3",
                "events_url": "https://api.github.com/users/jesussales/events{/privacy}",
                "followers_url": "https://api.github.com/users/jesussales/followers",
                "following_url": "https://api.github.com/users/jesussales/following{/other_user}",
                "gists_url": "https://api.github.com/users/jesussales/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jesussales",
                "id": 2803224,
                "login": "jesussales",
                "organizations_url": "https://api.github.com/users/jesussales/orgs",
                "received_events_url": "https://api.github.com/users/jesussales/received_events",
                "repos_url": "https://api.github.com/users/jesussales/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jesussales/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jesussales/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jesussales"
            }
        },
        {
            "body": "@shirioko :+1: You are right :)",
            "created_at": "2014-05-27T22:20:09Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747#issuecomment-44343026",
            "id": 44343026,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
            "updated_at": "2014-05-27T22:20:09Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/44343026",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747/comments",
    "created_at": "2014-05-27T11:32:58Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T12:05:57Z",
            "event": "mentioned",
            "id": 125061380,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125061380"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T12:05:57Z",
            "event": "subscribed",
            "id": 125061381,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125061381"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T12:24:25Z",
            "event": "mentioned",
            "id": 125066735,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125066735"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T12:24:25Z",
            "event": "subscribed",
            "id": 125066736,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125066736"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T12:39:28Z",
            "event": "mentioned",
            "id": 125072190,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125072190"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T12:39:28Z",
            "event": "subscribed",
            "id": 125072191,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125072191"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T22:20:09Z",
            "event": "mentioned",
            "id": 125328706,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125328706"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-05-27T22:20:09Z",
            "event": "subscribed",
            "id": 125328707,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125328707"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            },
            "commit_id": null,
            "created_at": "2014-05-27T22:20:09Z",
            "event": "closed",
            "id": 125328708,
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/125328708"
        }
    ],
    "events_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747/events",
    "html_url": "https://github.com/venomous0x/WhatsAPI/issues/747",
    "id": 34363378,
    "labels": [],
    "labels_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 747,
    "state": "closed",
    "title": "Check online status",
    "updated_at": "2014-08-17T17:39:34Z",
    "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/747",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
        "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
        "followers_url": "https://api.github.com/users/mgp25/followers",
        "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
        "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/mgp25",
        "id": 5390120,
        "login": "mgp25",
        "organizations_url": "https://api.github.com/users/mgp25/orgs",
        "received_events_url": "https://api.github.com/users/mgp25/received_events",
        "repos_url": "https://api.github.com/users/mgp25/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/mgp25"
    }
}