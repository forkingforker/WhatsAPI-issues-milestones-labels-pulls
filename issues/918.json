{
    "assignee": null,
    "body": "Hello,\r\n\r\nwill im trying to see if user was online is the past 30 days. then delete the user if false from my contacts. so i tried the event with no luck i can't get it to work.\r\nhere is my code\r\n_______________________________\r\nfunction onGetRequestLastSeen($username, $msgid, $seconds){\r\n    $oldseentime = strtotime(\"-30 day\");\r\n    $getseentime = explode('-',$seconds);    \r\n    $lastseentime = $getseentime[1];\r\n    if ($lastseentime >= $oldseentime) {\r\n\treturn array(true, $lastseentime);\r\n    }else{\r\n\treturn array(false, $lastseentime);\r\n    }\r\n}\r\n\r\n$w->eventManager()->bind('onGetRequestLastSeen', 'onGetRequestLastSeen');\r\n\r\nprint_r($w->sendGetRequestLastSeen($target));\r\n________________________________\r\n\r\ni get nothing i tried without the array also nothing :(\r\n\r\nwhen i try to echo $lastseentime inside the function it works.\r\n\r\n\r\nplease help me with this thank you.\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "body": "Use this function:\r\n\r\n```php\r\nfunction onGetRequestLastSeen($username, $from, $msgid, $seconds)\r\n{\r\n\t//echo \"Received last seen seconds: '$seconds'\";\r\n    //$now = time();\r\n    //$lastSeen = $now - $seconds;\r\n   \r\n    $secondsInAMinute = 60;\r\n    $secondsInAnHour  = 60 * $secondsInAMinute;\r\n    $secondsInADay    = 24 * $secondsInAnHour;\r\n\r\n    // extract days\r\n    $days = floor($seconds / $secondsInADay);\r\n\r\n    // extract hours\r\n    $hourSeconds = $seconds % $secondsInADay;\r\n    $hours = floor($hourSeconds / $secondsInAnHour);\r\n\r\n    // extract minutes\r\n    $minuteSeconds = $hourSeconds % $secondsInAnHour;\r\n    $minutes = floor($minuteSeconds / $secondsInAMinute);\r\n\r\n    // extract the remaining seconds\r\n    $remainingSeconds = $minuteSeconds % $secondsInAMinute;\r\n    $seconds = ceil($remainingSeconds);\r\n\r\n    // return the value\r\n    \techo \"- Last seen: \" . $days . \" days \" . $hours . \" hours \" . $minutes . \" minutes ago\\n\";\r\n}\r\n```\r\n\r\nAlso you can use this simplified function:\r\n\r\n```php\r\nfunction onGetRequestLastSeen($username, $from, $msgid, $seconds) {\r\n    $dtF = new DateTime(\"@0\");\r\n    $dtT = new DateTime(\"@$seconds\");\r\n    return $dtF->diff($dtT)->format('- Last seen: %a days, %h hours, %i minutes and %s seconds ago');\r\n}\r\n```\r\n\r\nRemember to add localtime if you havent that configured. \r\n\r\nFor example:\r\n\r\n```php\r\n<?\r\ndate_default_timezone_set('Europe/Madrid');\r\n....\r\n```\r\n\r\nbind the event.\r\n\r\n```php\r\n$w->eventManager()->bind('onGetRequestLastSeen', 'onGetRequestLastSeen');\r\n```\r\n\r\nCall function:\r\n\r\n```php\r\n$w->sendGetRequestLastSeen($target);\r\n```",
            "created_at": "2014-08-30T00:23:13Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/918#issuecomment-53942927",
            "id": 53942927,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918",
            "updated_at": "2014-08-30T00:24:53Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/53942927",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        },
        {
            "body": "thank you. that's a really neat code\r\nbut it still doesn't fix my problem. in your code can i save the days, hours and mins in an array and use it somewhere else?\r\nlike\r\n// return the value\r\n        //echo \"- Last seen: \" . $days . \" days \" . $hours . \" hours \" . $minutes . \" minutes ago\\n\";\r\n        return array($days,$hours,$minutes);\r\n}\r\n\r\nand use it like\r\n\r\n$my_time_array = $w->sendGetRequestLastSeen($target);\r\n\r\nbecause that didn't work with me.\r\n\r\n\r\nthank you again.",
            "created_at": "2014-08-30T00:43:28Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/918#issuecomment-53943706",
            "id": 53943706,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918",
            "updated_at": "2014-08-30T00:45:44Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/53943706",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8595021?v=3",
                "events_url": "https://api.github.com/users/acekun/events{/privacy}",
                "followers_url": "https://api.github.com/users/acekun/followers",
                "following_url": "https://api.github.com/users/acekun/following{/other_user}",
                "gists_url": "https://api.github.com/users/acekun/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/acekun",
                "id": 8595021,
                "login": "acekun",
                "organizations_url": "https://api.github.com/users/acekun/orgs",
                "received_events_url": "https://api.github.com/users/acekun/received_events",
                "repos_url": "https://api.github.com/users/acekun/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/acekun/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/acekun/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/acekun"
            }
        },
        {
            "body": "It seems you doesn't know too much about programming. If you want the function to return the value, use  something like this:\r\n\r\n```php\r\nreturn \"- Last seen: \" . $days . \" days \" . $hours . \" hours \" . $minutes . \" minutes ago\\n\";\r\n```",
            "created_at": "2014-08-30T09:03:25Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/918#issuecomment-53953152",
            "id": 53953152,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918",
            "updated_at": "2014-08-30T09:03:25Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/53953152",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918/comments",
    "created_at": "2014-08-29T23:27:20Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-09-01T17:03:39Z",
            "event": "labeled",
            "id": 159722631,
            "label": {
                "color": "cc317c",
                "name": "question"
            },
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/159722631"
        }
    ],
    "events_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918/events",
    "html_url": "https://github.com/venomous0x/WhatsAPI/issues/918",
    "id": 41547909,
    "labels": [
        {
            "color": "cc317c",
            "name": "question",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/labels/question"
        }
    ],
    "labels_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 918,
    "state": "open",
    "title": "return variable in event function onGetRequestLastSeen",
    "updated_at": "2014-09-01T17:03:39Z",
    "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/918",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/8595021?v=3",
        "events_url": "https://api.github.com/users/acekun/events{/privacy}",
        "followers_url": "https://api.github.com/users/acekun/followers",
        "following_url": "https://api.github.com/users/acekun/following{/other_user}",
        "gists_url": "https://api.github.com/users/acekun/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/acekun",
        "id": 8595021,
        "login": "acekun",
        "organizations_url": "https://api.github.com/users/acekun/orgs",
        "received_events_url": "https://api.github.com/users/acekun/received_events",
        "repos_url": "https://api.github.com/users/acekun/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/acekun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acekun/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/acekun"
    }
}