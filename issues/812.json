{
    "assignee": null,
    "body": "I am using it after connect and login.\r\n\r\n$wtp->sendPresenceSubscription($target);\r\n\r\nBut, only see a message says : \r\n\r\ntx  \\<presence type=\"subscribe\" to=\"xxx@s.whatsapp.net\"></presence\\>\r\n\r\n\r\n\t\t$wtp->eventManager()->bind('onPresence', \"onPresence\");\r\n\r\neven subscribe this event manager and having it's function, onPresence() function can not return anything.\r\n\r\nServer never return a node with tag \"presence\". \r\n\r\nI tried to add these lines to the whatsport.class.php:\r\n\r\n        if ($node->getTag() == \"presence\"){\r\n        \t$this->debugPrint(\"bla.bla.bla\");\r\n        }\r\n\r\nBut server never return anything tagged with \"presence\".\r\n\r\nI only see the my presence subscription. (tx \\<presence ...)\r\n\r\nIs this tag changed? (\"presence\") Or i am doing a big mistake?\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "body": "*sigh* you get this:\r\n```\r\ntx  <presence type=\"subscribe\" to=\"number@s.whatsapp.net\"></presence>\r\n```\r\nthe getTag() == \"presence\" its fine because as you can see in the debug, the tag is called presence...\r\n\r\nYou have to code the function 'onPresence' in your script as you are binding the event.",
            "created_at": "2014-06-27T22:39:58Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47407755",
            "id": 47407755,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-06-27T22:40:13Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47407755",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        },
        {
            "body": "Thanks for your reply.\r\n\r\nI did exactly what you say, but it does not seems working.\r\nLook my code:\r\n--------------------------------------------------------\r\n<html>\r\nfunction onPresence(\r\n\t\t\t\t$phone, // The user phone number including the country code.\r\n\t\t\t\t$from, // The sender JID.\r\n\t\t\t\t$type // The presence type.\r\n\t\t){\r\n                               file_put_contents(\"presence_occured.txt\", \"bonjour\");\r\n\t\t}\r\n\r\n$wtp = new WhatsProt($number, $id, $nick, true);\r\n\r\n$wtp->eventManager()->bind('onPresence', \"onPresence\");\r\n\r\n$wtp->connect();\r\n$wtp->loginWithPassword($password);\r\n\r\n$wtp->sendPresenceSubscription($number_which_i_want_to_subscribe_his_presence);\r\n\r\nwhile(isset($_SESSION['logged_in']) ){ \r\n     $wtp->pollMessages();\r\n}\r\n\r\n</html>\r\nWhy, i can't see a file which mean that onPresence() function run.\r\n\r\n\t\t",
            "created_at": "2014-06-27T22:58:06Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47408776",
            "id": 47408776,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-06-27T22:59:00Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47408776",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1779207?v=3",
                "events_url": "https://api.github.com/users/yusufgungor/events{/privacy}",
                "followers_url": "https://api.github.com/users/yusufgungor/followers",
                "following_url": "https://api.github.com/users/yusufgungor/following{/other_user}",
                "gists_url": "https://api.github.com/users/yusufgungor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yusufgungor",
                "id": 1779207,
                "login": "yusufgungor",
                "organizations_url": "https://api.github.com/users/yusufgungor/orgs",
                "received_events_url": "https://api.github.com/users/yusufgungor/received_events",
                "repos_url": "https://api.github.com/users/yusufgungor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yusufgungor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yusufgungor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yusufgungor"
            }
        },
        {
            "body": "Now when the user (you have subscribed to) goes 'available' or 'unavailable' it will fire your function. Just do an echo $type if you want to test it first. Set debug to true, to see whats happening, you will understand better.",
            "created_at": "2014-06-27T23:07:09Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47409222",
            "id": 47409222,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-06-27T23:51:44Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47409222",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        },
        {
            "body": "I tried, but does not working :(\r\n\r\nThe server never returns a node which tagged \"presence\" so the \"onPresence\" function never getting fired.\r\n\r\nI can send presence subscription to a number and can see it on the debug.\r\n\r\nFor debugging more closer, i deactivated the all fire codes on the whatsprot.class.php about presence subscription.\r\n\r\nOnly added lines below :\r\n\r\nif ($node->getTag() == \"presence\"){\r\n        \tfile_put_contents(\"test.txt\", \"Server sent presence tag\");\r\n}\r\n\r\nBut it seems that, server never send \"presence\" tag to me. (I subscribed to the a number, i can see it in the debug with a prefix \"tx\")",
            "created_at": "2014-06-29T21:50:01Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47477457",
            "id": 47477457,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-06-29T21:50:43Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47477457",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1779207?v=3",
                "events_url": "https://api.github.com/users/yusufgungor/events{/privacy}",
                "followers_url": "https://api.github.com/users/yusufgungor/followers",
                "following_url": "https://api.github.com/users/yusufgungor/following{/other_user}",
                "gists_url": "https://api.github.com/users/yusufgungor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yusufgungor",
                "id": 1779207,
                "login": "yusufgungor",
                "organizations_url": "https://api.github.com/users/yusufgungor/orgs",
                "received_events_url": "https://api.github.com/users/yusufgungor/received_events",
                "repos_url": "https://api.github.com/users/yusufgungor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yusufgungor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yusufgungor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yusufgungor"
            }
        },
        {
            "body": "Do you have the latest version of the API? Because its working. As i send you above, it send a tag <presence>",
            "created_at": "2014-06-29T22:11:10Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47478700",
            "id": 47478700,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-06-29T22:11:10Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47478700",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        },
        {
            "body": "I'll download the latest version and gonna test it again. Thanks for your reply. ",
            "created_at": "2014-06-29T22:12:16Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47478765",
            "id": 47478765,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-06-29T22:12:16Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47478765",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1779207?v=3",
                "events_url": "https://api.github.com/users/yusufgungor/events{/privacy}",
                "followers_url": "https://api.github.com/users/yusufgungor/followers",
                "following_url": "https://api.github.com/users/yusufgungor/following{/other_user}",
                "gists_url": "https://api.github.com/users/yusufgungor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yusufgungor",
                "id": 1779207,
                "login": "yusufgungor",
                "organizations_url": "https://api.github.com/users/yusufgungor/orgs",
                "received_events_url": "https://api.github.com/users/yusufgungor/received_events",
                "repos_url": "https://api.github.com/users/yusufgungor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yusufgungor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yusufgungor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yusufgungor"
            }
        },
        {
            "body": "Thanks too much, latest version solve the problem.\r\n\r\nAlso, i commented $this->sendAvailableForChat(); line at whatsprot.class.php\r\n\r\nBecause of commenting this line, onMessageComposing() and onMessagePaused() can not firing.\r\nBut onPresence() function still firing. (if you subscribed to a number) \r\n\r\nThis caused to lose too much time for me. I am writing here to help others.",
            "created_at": "2014-07-02T21:06:26Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47836669",
            "id": 47836669,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-07-02T21:06:26Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47836669",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1779207?v=3",
                "events_url": "https://api.github.com/users/yusufgungor/events{/privacy}",
                "followers_url": "https://api.github.com/users/yusufgungor/followers",
                "following_url": "https://api.github.com/users/yusufgungor/following{/other_user}",
                "gists_url": "https://api.github.com/users/yusufgungor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yusufgungor",
                "id": 1779207,
                "login": "yusufgungor",
                "organizations_url": "https://api.github.com/users/yusufgungor/orgs",
                "received_events_url": "https://api.github.com/users/yusufgungor/received_events",
                "repos_url": "https://api.github.com/users/yusufgungor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yusufgungor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yusufgungor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yusufgungor"
            }
        },
        {
            "body": "**Reference #814**",
            "created_at": "2014-07-02T23:54:12Z",
            "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812#issuecomment-47851884",
            "id": 47851884,
            "issue_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
            "updated_at": "2014-07-02T23:55:35Z",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/comments/47851884",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5390120?v=3",
                "events_url": "https://api.github.com/users/mgp25/events{/privacy}",
                "followers_url": "https://api.github.com/users/mgp25/followers",
                "following_url": "https://api.github.com/users/mgp25/following{/other_user}",
                "gists_url": "https://api.github.com/users/mgp25/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mgp25",
                "id": 5390120,
                "login": "mgp25",
                "organizations_url": "https://api.github.com/users/mgp25/orgs",
                "received_events_url": "https://api.github.com/users/mgp25/received_events",
                "repos_url": "https://api.github.com/users/mgp25/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mgp25/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mgp25/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mgp25"
            }
        }
    ],
    "comments": 8,
    "comments_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812/comments",
    "created_at": "2014-06-27T19:40:44Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-06-30T23:48:36Z",
            "event": "labeled",
            "id": 136760284,
            "label": {
                "color": "cc317c",
                "name": "question"
            },
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/136760284"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1610953?v=3",
                "events_url": "https://api.github.com/users/shirioko/events{/privacy}",
                "followers_url": "https://api.github.com/users/shirioko/followers",
                "following_url": "https://api.github.com/users/shirioko/following{/other_user}",
                "gists_url": "https://api.github.com/users/shirioko/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shirioko",
                "id": 1610953,
                "login": "shirioko",
                "organizations_url": "https://api.github.com/users/shirioko/orgs",
                "received_events_url": "https://api.github.com/users/shirioko/received_events",
                "repos_url": "https://api.github.com/users/shirioko/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shirioko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shirioko/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shirioko"
            },
            "commit_id": null,
            "created_at": "2014-06-30T23:48:47Z",
            "event": "labeled",
            "id": 136760312,
            "label": {
                "color": "006b75",
                "name": "User error"
            },
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/events/136760312"
        }
    ],
    "events_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812/events",
    "html_url": "https://github.com/venomous0x/WhatsAPI/issues/812",
    "id": 36697642,
    "labels": [
        {
            "color": "cc317c",
            "name": "question",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/labels/question"
        },
        {
            "color": "006b75",
            "name": "User error",
            "url": "https://api.github.com/repos/venomous0x/WhatsAPI/labels/User%20error"
        }
    ],
    "labels_url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 812,
    "state": "open",
    "title": "Problem with sendPresenceSubscription() ",
    "updated_at": "2014-07-02T23:55:35Z",
    "url": "https://api.github.com/repos/venomous0x/WhatsAPI/issues/812",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1779207?v=3",
        "events_url": "https://api.github.com/users/yusufgungor/events{/privacy}",
        "followers_url": "https://api.github.com/users/yusufgungor/followers",
        "following_url": "https://api.github.com/users/yusufgungor/following{/other_user}",
        "gists_url": "https://api.github.com/users/yusufgungor/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/yusufgungor",
        "id": 1779207,
        "login": "yusufgungor",
        "organizations_url": "https://api.github.com/users/yusufgungor/orgs",
        "received_events_url": "https://api.github.com/users/yusufgungor/received_events",
        "repos_url": "https://api.github.com/users/yusufgungor/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/yusufgungor/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yusufgungor/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/yusufgungor"
    }
}